# Руководство по экспорту текста из Word на сайт

## Текущий метод (MHT файл)

Сейчас используется **MHT файл** (`text.mht`), который:
- ✅ Сохраняет форматирование
- ✅ Включает все изображения
- ✅ Сохраняет структуру документа
- ❌ Содержит много лишнего кода от Word
- ❌ Требует специального парсинга

## Рекомендуемые методы экспорта

### 1. **HTML (Фильтрованный) - РЕКОМЕНДУЕТСЯ** ⭐

**Как экспортировать:**
1. В Word: `Файл` → `Сохранить как` → `Веб-страница, фильтрованная (*.htm; *.html)`
2. Выберите "Веб-страница, фильтрованная"
3. Сохраните как `text.html`

**Преимущества:**
- ✅ Чистый HTML код
- ✅ Минимум лишних тегов
- ✅ Легко парсится
- ✅ Сохраняет основное форматирование
- ✅ Меньший размер файла

**Недостатки:**
- ❌ Может потерять сложное форматирование
- ❌ Изображения сохраняются отдельно

### 2. **Markdown + Pandoc** (Для продвинутых)

**Как использовать:**
1. Экспортируйте из Word в Markdown через Pandoc:
   ```bash
   pandoc document.docx -o document.md
   ```
2. Конвертируйте Markdown в HTML:
   ```bash
   pandoc document.md -o document.html
   ```

**Преимущества:**
- ✅ Очень чистый код
- ✅ Легко редактировать
- ✅ Отличная поддержка форматирования
- ✅ Можно использовать Markdown редакторы

**Недостатки:**
- ❌ Требует установки Pandoc
- ❌ Может потерять сложное форматирование

### 3. **Чистый HTML (ручное редактирование)**

**Как использовать:**
1. Экспортируйте из Word в HTML
2. Откройте в текстовом редакторе
3. Удалите лишние теги вручную
4. Оставьте только нужную структуру

**Преимущества:**
- ✅ Полный контроль над кодом
- ✅ Минимальный размер
- ✅ Оптимизированный код

**Недостатки:**
- ❌ Требует времени на ручную обработку
- ❌ Нужны знания HTML

### 4. **Текущий метод (MHT) - Улучшенный**

Можно улучшить текущий парсер для лучшей обработки MHT файлов:
- Более точное извлечение контента
- Лучшая очистка от Word-тегов
- Сохранение структуры

## Рекомендация

**Используйте "Веб-страница, фильтрованная" из Word:**

1. Откройте документ в Word
2. `Файл` → `Сохранить как`
3. Выберите тип: **"Веб-страница, фильтрованная (*.htm; *.html)"**
4. Сохраните как `text.html` в корне проекта
5. Запустите импорт: `python manage.py import_theory`

Этот метод даст:
- Чистый HTML код
- Хорошую структуру
- Легкий парсинг
- Сохранение форматирования

## Что делать после экспорта

1. **Проверьте файл** - откройте в браузере, убедитесь что всё отображается
2. **Запустите импорт:**
   ```bash
   python manage.py import_theory
   ```
3. **Проверьте результат** на странице `/theory/`
4. **Отредактируйте через админ-панель** если нужно

## Альтернатива: Прямое редактирование в админ-панели

Если экспорт не работает идеально, можно:
1. Скопировать текст из Word
2. Вставить в админ-панель Django
3. Добавить HTML теги вручную:
   - `<p>` для параграфов
   - `<h2>`, `<h3>` для заголовков
   - `<ul>`, `<ol>`, `<li>` для списков
   - `<strong>`, `<em>` для выделения

## Текущая поддержка форматов

Система поддерживает:
- ✅ `.mht` файлы (MHTML)
- ✅ `.html` файлы
- ✅ `.htm` файлы

Приоритет: сначала ищется `text.mht`, затем `text.html`, затем `text.htm`

